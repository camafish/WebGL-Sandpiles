data = list(c(4, -2.18025597576e-12, 0.50000000001, -1.50000000001, -3.0), c(5, -2.18292051102e-12, 0.285714286209, -1.14285714503, -3.02857142647), c(6, -2.18269846641e-12, 0.500000000016, -2.50000000003, -3.99999999999), c(7, -2.1822543772e-12, 0.357142856027, -2.14285713552, -4.0714285788), c(8, -2.17803552971e-12, 0.583333334099, -4.08333333909, -6.16666665929), c(9, -2.17958984194e-12, 0.45238095238, -3.61904761906, -6.33333333335), c(10, -2.1820323326e-12, 0.60606060606, -5.45454545456, -7.12727272729), c(11, -2.1820323326e-12, 0.496503496312, -4.96503496307, -7.37062937284), c(12, -2.17870166352e-12, 0.594905096677, -6.54395606314, -9.59340624393), c(13, -2.18092210957e-12, 0.50349650816, -6.04195809772, -9.92307652754), c(14, -2.18114415418e-12, 0.593406551486, -7.71428516935, -10.5714288439), c(15, -2.1822543772e-12, 0.515352265173, -7.21493171245, -10.9676471935), c(16, -2.18092210957e-12, 0.598739495989, -8.98109243995, -13.2941176359), c(17, -2.17981188655e-12, 0.528637770355, -8.45820432445, -13.7956656653), c(18, -2.18092210957e-12, 0.622549013702, -10.583333233, -14.3333323295), c(19, -2.18158824339e-12, 0.557275529955, -10.0309595387, -14.9473676161), c(20, -2.17892370813e-12, 0.614718591251, -11.6796532338, -16.9610395358), c(21, -2.18092210957e-12, 0.556717862841, -11.1343572569, -17.6459631982), c(22, -2.17936779734e-12, 0.626482204553, -13.1561262957, -19.9644266325), c(23, -2.17958984194e-12, 0.572049682655, -12.5850930185, -20.7782605628), c(24, -2.17936779734e-12, 0.639723316504, -14.7136362796, -20.7999993545), c(25, -2.18092210957e-12, 0.588703081944, -14.1288739667, -21.7193155455), c(26, -2.18025597576e-12, 0.623076919445, -15.5769229852, -24.3846145757), c(27, -2.18114415418e-12, 0.577011491875, -15.0022987888, -25.3793094721), c(28, -2.1775914405e-12, 0.636394261781, -17.1826450681, -25.2561569496), c(29, -2.18025597576e-12, 0.592616138571, -16.5932518801, -26.364849167), c(30, -2.18070006497e-12, 0.62055061179, -17.995967742, -29.085483871), c(31, -2.18158824339e-12, 0.580619880675, -17.4185964203, -30.2617302053), c(32, -2.18358664483e-12, 0.638045548775, -19.7794120121, -31.102939463), c(33, -2.1822543772e-12, 0.599355585434, -19.179378734, -32.4216942609), c(34, -2.18047802036e-12, 0.618601990619, -20.4138656905, -34.0672258971), c(35, -2.18158824339e-12, 0.58336258769, -19.834327979, -35.4254816187), c(36, -2.18047802036e-12, 0.634053341718, -22.1918669602, -37.2460859543), c(37, -2.18092210957e-12, 0.599784289131, -21.5922344071, -38.7480007484), c(38, -2.18003393115e-12, 0.628861657107, -23.267881313, -38.2874488638), c(39, -2.18070006497e-12, 0.596783020027, -22.6777547582, -39.8461532584), c(40, -2.18136619878e-12, 0.630887725881, -24.6046213094, -42.6707317074), c(41, -2.18003393115e-12, 0.600132142389, -24.0052856956, -44.3558868812), c(42, -2.18114415418e-12, 0.639958456702, -26.2382967249, -43.4113548047), c(43, -2.17803552971e-12, 0.610220185724, -25.6292478005, -45.2156435515), c(44, -2.18070006497e-12, 0.637007080609, -27.3913044613, -47.2608686337), c(45, -2.17914575273e-12, 0.608786922822, -26.7866246043, -49.1403012781))
data = list(c(6, -2.0, -2.91666666679, -0.458333333124, 0.416666666548, -0.0416666666394, -2.1820323326e-12), 
            c(7, -1.98484848485, -3.95454545456, 0.931818181818, -0.0909090909114, 0.00757575757355, -2.1775914405e-12), 
            c(8, -1.99242424242, -5.32954545458, 0.111742424253, 0.1856060606, -0.0132575757592, -2.21556106794e-12), 
            c(9, -1.94638695408, -6.21911417222, 1.00116546537, -0.0559440479812, 0.00349650298197, -2.18292051102e-12), 
            c(10, -2.99300707601, -4.60489495878, -0.668414821671, 0.262237736817, -0.0145687631181, -2.18536300167e-12), 
            c(11, -2.90209803548, -5.54778500317, 0.0885779229672, 0.0932401154669, -0.00466200577555, -2.18713935851e-12), 
            c(12, -3.00000022891, -5.3846147572, -0.779720384125, 0.230769239, -0.0104895108207, -2.18425277865e-12), 
            c(13, -2.8506790135, -6.38296900895, -0.124606068983, 0.109420025508, -0.00455916773188, -2.17559303906e-12), 
            c(14, -2.9369749101, -5.35294088625, -1.02205888176, 0.220588240816, -0.00848416311058, -2.18092210957e-12), 
            c(15, -2.72058839917, -6.40466843124, -0.439479752648, 0.128136581307, -0.00457630647746, -2.18314255562e-12), 
            c(16, -2.66228109297, -6.18420950628, -1.0679827392, 0.197368449725, -0.00657894832645, -2.18003393115e-12), 
            c(17, -2.35913355977, -7.31713790168, -0.530850900621, 0.123521502432, -0.00386004695324, -2.18136619878e-12), 
            c(18, -2.95853255823, -7.25498427222, -0.944149177795, 0.161283877468, -0.00474364345704, -2.18802753693e-12), 
            c(19, -2.61764065283, -8.31780608302, -0.497217364646, 0.10659085584, -0.00296085710886, -2.18358664483e-12), 
            c(20, -3.92885364154, -6.91242306663, -1.1874942559, 0.163295368019, -0.00429724652858, -2.19890772257e-12), 
            c(21, -3.49023136135, -8.05991637702, -0.758464059749, 0.116145987857, -0.00290364969857, -2.18380868944e-12), 
            c(22, -3.48726056622, -7.62110703886, -1.25808676465, 0.154380630825, -0.00367572930802, -2.16648921025e-12), 
            c(23, -2.92530657622, -8.87110055066, -0.840934872135, 0.11310606502, -0.0025705923883, -2.20601314993e-12), 
            c(24, -3.46666666696, -8.91487956468, -1.10239265571, 0.129564879568, -0.00281662781904, -2.1775914405e-12), 
            c(25, -2.87303271179, -10.0899829824, -0.743253955382, 0.0969724927363, -0.00202026026683, -2.20379270388e-12), 
            c(26, -3.43059269361, -8.54004308031, -1.28395143406, 0.130044252584, -0.00260088505427, -2.17048601314e-12), 
            c(27, -2.72426178763, -9.7832958731, -0.936007431405, 0.100945233993, -0.00194125450226, -2.17648121748e-12), 
            c(28, -2.88008444043, -9.60421160884, -1.217293366, 0.116518882003, -0.00215775707637, -2.18047802036e-12), 
            c(29, -2.1017792658, -10.8400474004, -0.898055471719, 0.0918000015374, -0.00163928574321, 5.22744915381e-13), 
            c(30, -2.65063884614, -9.54038726926, -1.30310335004, 0.112557394571, -0.0019406447359, -2.18891571535e-12), 
            c(31, -1.77447540538, -10.8056005694, -0.999761773501, 0.0906632300178, -0.0015110538427, 2.98219680741e-12), 
            c(32, -2.0337560591, -10.973471761, -1.22216350833, 0.101686868912, -0.00164011079072, 9.50065054995e-13), 
            c(33, -1.08050246243, -12.2372220334, -0.93951527933, 0.0826205292369, -0.00129094577155, 3.57569144038e-13), 
            c(34, -2.2585000264, -10.5334541594, -1.30460126993, 0.0984119303479, -0.00149108985689, 4.15998275937e-13), 
            c(35, -1.24247741197, -11.7856572828, -1.04083675327, 0.0816161018821, -0.00120023679416, -2.19047002759e-12), 
            c(36, -2.28126867713, -11.6960240601, -1.27787703034, 0.0921170940682, -0.00131595848858, -2.18780549233e-12), 
            c(37, -1.16071186226, -12.9752756208, -1.02496527751, 0.0769660888926, -0.00106897345865, 5.70851356809e-13), 
            c(38, -2.29297874463, -11.392834596, -1.35830592372, 0.0900659660713, -0.00121710765207, -2.17648121748e-12), 
            c(39, -1.07899517454, -12.6881552579, -1.11625013344, 0.0763236292716, -0.00100425828257, -2.17204032538e-12), 
            c(40, -2.10958980856, -12.5985628336, -1.29026182298, 0.0827334305456, -0.00106068500931, -2.17914575273e-12), 
            c(41, -0.825969477091, -13.8821590686, -1.06319962057, 0.0705126798492, -0.000881408500664, 3.18961348436e-13), 
            c(42, -1.78300266415, -12.5772407684, -1.38103471631, 0.0823315456667, -0.00100404324228, 5.0943583168e-13), 
            c(43, -0.353410446412, -13.9177663439, -1.15643674854, 0.070848197058, -0.000843430920758, -2.16049400592e-12), 
            c(44, -0.855098808758, -13.920893887, -1.28771660731, 0.0749515212256, -0.000871528156823, -1.92508331617e-11), 
            c(45, 0.603340020722, -15.2179564198, -1.08023603936, 0.0648226478645, -0.000736620225403, -1.24951134966e-11))

df = as.data.frame(t(as.data.frame(data)))
rownames(df)<-NULL


model1 = lm(df$V2 ~ df$V1)
model2 = lm(df$V3 ~ df$V1)
model3 = lm(df$V4 ~ df$V1)
model4 = lm(df$V5 ~ df$V1)
model5 = lm(df$V6 ~ df$V1)
model6 = lm(df$V7 ~ df$V1)

coeff_estimator = function(n){
  a = coef(model1)[[1]] + coef(model1)[[2]]*n
  b = coef(model2)[[1]] + coef(model2)[[2]]*n
  c = coef(model3)[[1]] + coef(model3)[[2]]*n
  d = coef(model4)[[1]] + coef(model4)[[2]]*n
  e = coef(model5)[[1]] + coef(model5)[[2]]*n
  f = coef(model6)[[1]] + coef(model6)[[2]]*n
  
  c(n, a, b, c, d, e, f)
}

i = 45
coeff_estimator(i)
c(i, df$V2[i - 4], df$V3[i - 4], df$V4[i - 4])

output = list()
for (i in 4:46){
  output[[i]] = coeff_estimator(i)
}

print(output)

format(coef(model1)[[1]], scientific = FALSE)
format(coef(model1)[[2]], scientific = FALSE)

format(coef(model2)[[1]], scientific = FALSE)
format(coef(model2)[[2]], scientific = FALSE)

format(coef(model3)[[1]], scientific = FALSE)
format(coef(model3)[[2]], scientific = FALSE)

format(coef(model4)[[1]], scientific = FALSE)
format(coef(model4)[[2]], scientific = FALSE)

format(coef(model5)[[1]], scientific = FALSE)
format(coef(model5)[[2]], scientific = FALSE)

format(coef(model6)[[1]], scientific = FALSE)
format(coef(model6)[[2]], scientific = FALSE)

